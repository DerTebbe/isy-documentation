[[generierung-von-boilerplate-code]]
= Generierung von Boilerplate Code

[[die-equals-und-hashcode-methode]]
== Die equals() und hashCode() Methode

Alle Klassen leiten sich von der Basisklasse Object ab und erben von dieser die Methoden `equals()`, `hashCode()`, `toString()`, `clone()` und `finalize()`. Diese Methoden sind bewusst
als _non-final_ Methoden angelegt, damit diese Methoden klassenspezifisch angepasst werden können.

Die von der Klasse `Object` vererbte Implementierung für die Methoden `equals()` und `hashCode()` stellt nur eine Basisimplementierung dar, die für die meisten Klassen genügt.
Für andere Klassen ist diese Basisimplementierung jedoch zu unspezifisch und kann, wenn der Code der Methoden nicht auf die Klasse angepasst wird, zu schwer identifizierbaren Fehlern führen.

Die Programmierung der `equals()` und `hashCode()` Methode ist nicht trivial, da ein „general contract“ (Reflexivity, Symmetry, Transitivity, Consistency und Non-nullity)
einzuhalten ist <<Bloch2008>>.

Eine Unterstützung bei der Codegenerierung erhält der Programmentwickler bei Einsatz von IntelliJ IDEA programmseitig. Um bei der derzeit aktuellen Eclipse Version _Neon_ identische Umsetzungen der beiden Methode zu generieren, wird das Plugin _jenerate_ verwendet.

[[eclipse-boilerplate-code-plugin-jenerate]]
== Eclipse Boilerplate Code Plugin _jenerate_
[[installation]]
=== Installation

Das Eclipse Plugin _jenerate_ kann innerhalb von Eclipse über den _„Eclipse Marketplace“_ heruntergeladen und installiert werden.

Eclipse Menüpunkt: menu:Help[Eclipse Marketplace]

:desc-image-eclipse-marketplace-pluginauswahl: Eclipse Marketplace, Pluginauswahl
[id="image-eclipse-marketplace-pluginauswahl",reftext="{figure-caption} {counter:figures}"]
.{desc-image-eclipse-marketplace-pluginauswahl}
image::Einrichtung_Entwicklungsumgebung_001.png[align="center",width=80%,pdfwidth=80%]

[[grundkonfiguration]]
=== Grundkonfiguration

Bestimmte Einstellungen zur Steuerung der Erzeugung von Boilerplate Code können bei Eclipse über das Menü menu:Window[Preferences > Java > Jenerate] vorgenommen werden.

Der folgende Screenshot zeigt die Einstellungen, die bei der Boilerplate-Code-Erstellung eine hohe Übereinstimmung mit dem von IntelliJ IDEA erzeugten Boilerplate Code ergibt.

:desc-image-jenerate-grundeinstellungen: Eclipse Plugin jenerate - Grundeinstellungen
[id="image-jenerate-grundeinstellungen",reftext="{figure-caption} {counter:figures}"]
.{desc-image-jenerate-grundeinstellungen}
image::Einrichtung_Entwicklungsumgebung_002.png[align="center"]

[[boilerplate-code-erzeugen]]
=== Boilerplate Code erzeugen

Die Generierung von Boilerplate Code selbst ist intuitiv und erfolgt in drei Schritten.

*Schritt 1:* Die Klasse wird wie üblich angelegt. Wichtig ist, dass alle für die zu generierenden Methoden relevanten Klassenvariablen bereits in der Klasse enthalten sind.

*Schritt 2:* Im Editor der Klasse ruft die Tastenkombination kbd:[Alt + Shift + G] ein kleines Auswahlmenü auf, das Optionen für die Erzeugung des Boilerplate Codes für eine der Methoden `compareTo()`, `equals()` & `hashCode()` oder `toString()` bietet.

:desc-image-jenerate-methodenauswahl: Plugin jenerate - Methodenauswahl
[id="image-jenerate-methodenauswahl",reftext="{figure-caption} {counter:figures}"]
.{desc-image-jenerate-methodenauswahl}
image::Einrichtung_Entwicklungsumgebung_003.png[align="center"]

Alternativ stehen die folgenden Tastenkombinationen zur Verfügung:

* `hashCode()` & `equals()`: kbd:[Alt + Shift + G], dann kbd:[H]
* `toString()` kbd:[Alt + Shift + G], dann kbd:[S]
* `compareTo()` kbd:[Alt + Shift + G], dann kbd:[C]

*Schritt 3:* Nach Auswahl der zu erzeugenden Methoden öffnet sich ein Auswahlfenster, auf dem man aus der Menge der im ersten Schritt angelegten Klassenvariablen diejenigen auswählen kann, die bei der Codegenerierung als Parameter einfließen sollen.

Werden Klassen zu einem späteren Zeitpunkt um weitere Klassenvariablen ergänzt, welche für die Methoden `compareTo()`, `equals()`, `hashCode()` oder `toString()` relevant sind, so kann der erzeugte Quellcode jederzeit wieder gelöscht und erneut erzeugt werden.

[[content-strategy-boilerplate-code]]
== Content Strategy Boilerplate Code

Bei der Boilerplate-Code-Generierung für die `equals()` und `hashCode()` Methoden kann man bei beiden IDEs zwischen verschiedenen Utility-Bibliotheken (__Commons Lang__,
__Guava__, …) und _java.util.Objects_ wählen.

Um bei beiden IDEs die gleiche Basis zu verwenden, ist jeweils die *Generierung mit _java.util.Objects_* auszuwählen.

[[eclipse]]
=== Eclipse

Über das Settingsmenü des Eclipse Plugins _jenerate_ lässt sich die Grundeinstellung der „__Content strategy__“ festlegen.

In dieser Grundeinstellungsmaske ist _java.util.Objects_ als zu verwendendes Codegenerierungsgrundobjekt auszuwählen.

Wenn man sich im Klasseneditor über das Plugin _jenerate_ die Methoden `equals()` und `hashCode()` generieren lässt, wird auf der Detailmaske zur Eingabe der zu verwendenden Parameter bei der Codegenerierung die in den Settings voreingestellte „__Content strategy__“ angezeigt.

Sollte in der _jenerate_ Grundeinstellungsmaske keine Vorauswahl oder eine andere Bildungsvorauswahl getroffen worden sein, so kann hier die zu verwendende Generierungsstrategie auf `USE_JAVA` (__java.util.Objects__) umgestellt werden.

:desc-image-Eclipse-Boilerplate: Eclipse Boilerplate Code Bildungsstrategie
[id="image-Eclipse-Boilerplate",reftext="{figure-caption} {counter:figures}"]
.{desc-image-Eclipse-Boilerplate}
image::Einrichtung_Entwicklungsumgebung_004.png[pdfwidth=40%,width=40%, align="center"]

[[intellij-idea]]
=== IntelliJ IDEA

Auch bei IntelliJ IDEA lässt sich die Codebildungsstrategie auswählen.
Diese ist im Generierungsdialog unter „Template“ einzustellen.

:desc-image-IntelliJ-Boilerplate: IntelliJ IDEA Boilerplate Code Bildungsstrategie
[id="image-IntelliJ-Boilerplate",reftext="{figure-caption} {counter:figures}"]
.{desc-image-IntelliJ-Boilerplate}
image::Einrichtung_Entwicklungsumgebung_005.png[align="center",width=70%,pdfwidth=70%]

[[formatierung-von-quellcode]]
= Formatierung von Quellcode

[[konfiguration]]
== Konfiguration

[[konfiguration-des-formatierungsstils]]
=== Konfiguration des Formatierungsstils

Die Code-Formatierungsregeln sind bei beiden IDEs (Eclipse und IntelliJ IDEA) über Konfigurationsmasken individuell einstellbar.
Es besteht die Möglichkeit, die Formatierungsregeln als XML-Datei abzuspeichern bzw.
vorhandene Formatierungsregeldateien zu importieren.

Zu den Formatierungskonfigurationsmasken gelangt man über folgende Menüeinträge:

* *Eclipse:* menu:Window[Preferences > Java > Code Style > Formatter]
* *IntelliJ IDEA:* menu:File[Settings > Editor > Code Style > Java]

[[tastaturkuerzel-codeformatierung]]
=== Tastaturkürzel Codeformatierung

Wenn man sich innerhalb eines Codefensters befindet, kann man mit folgenden Tastaturkürzeln die Code-Formatierung anstoßen.

* *Eclipse:* kbd:[Alt + Shift + F]
* *IntelliJ IDEA:* kbd:[Strg + Alt + L]

[[import-von-code-style-formatierungsdateien]]
=== Import von Code Style Formatierungsdateien

Dieses Kapitel erläutert den Import der Konfiguration zur Quellcode-Formatierung für die Entwicklungsumgebungen Eclipse und IntelliJ IDEA.

[[intellij-idea-1]]
==== IntelliJ IDEA

NOTE: Die in dieser Installationsbeschreibung erstellten Screenshots basieren auf der IntelliJ IDEA Version 2017.2.

*Schritt 1:* Konfigurationsmaske öffnen

* Menüeintrag menu:File[Settings > Code Style > Java]

*Schritt 2:* Import der Code-Formatter XML-Datei

* Dropdown-Icon Einstellungen anklicken image:Einrichtung_Entwicklungsumgebung_005b.png[width=5%,pdfwidth=5%]
* menu:Import Scheme[Intellij IDEA code style XML] auswählen
* In der daraufhin erscheinenden Dateiauswahlbox die zu importierende Datei auswählen

:desc-image-Code-Formatter: IntelliJ IDEA Code Formatter Import
[id="image-Code-Formatter",reftext="{figure-caption} {counter:figures}"]
.{desc-image-Code-Formatter}
image::Einrichtung_Entwicklungsumgebung_006.png[align="center"]

Anmerkung: Der Name der Datei kann vom Namen des Scheme abweichen. Welcher Scheme-Name angezeigt wird, entscheidet sich durch einen entsprechenden Eintrag innerhalb der importierten XML-Datei.

[[eclipse-1]]
==== Eclipse

NOTE: Die in dieser Installationsbeschreibung erstellten Screenshots basieren auf der Eclipse Version __Neon__.

*Schritt 1:* Konfigurationsmaske öffnen

* Menüeintrag menu:Window[Preferences > Java > Code Style > Formatter]

*Schritt 2:* Import der Code-Formatter XML-Datei

* Schaltfläche btn:[Import] anklicken
* In der daraufhin erscheinenden Dateiauswahlbox die zu importierende Datei auswählen

:desc-image-Code-Formatter2: Eclipse Code Formatter Import
[id="image-Code-Formatter2",reftext="{figure-caption} {counter:figures}"]
.{desc-image-Code-Formatter2}
image::Einrichtung_Entwicklungsumgebung_007.png[align="center"]

Anmerkung: Der Name der Datei kann vom Namen des aktiven Profiles des Formatters abweichen. Welcher Profilname angezeigt wird, entscheidet sich durch einen entsprechenden Eintrag innerhalb der importierten XML-Datei.

[[formatierungsdifferenzen]]
== Formatierungsdifferenzen

Mit Hilfe der Einstellungsmasken für die Formatierung bei den beiden IDEs ist eine fast vollständige Übereinstimmung bei der automatischen Formatierung des Quellcodes möglich. Dieses Kapitel führt die noch verbliebenen Differenzen anhand einer Gegenüberstellung auf und diskutiert kurz die Konsequenzen.

:desc-image-Democode: Democode zur Veranschaulichung von Formatierungseinstellungen (Eclipse)
[id="image-Democode",reftext="{figure-caption} {counter:figures}"]
.{desc-image-Democode}
image::Einrichtung_Entwicklungsumgebung_008.png[align="center"]

[[leere-zeilen-vor-dem-ende-des-kommentarblocks]]
===  Leere Zeilen vor dem Ende des Kommentarblocks

Im _javadoc_ Bereich löscht IntelliJ IDEA leere Kommentarzeilen, die vor dem Ende des Kommentarblocks stehen:

:desc-image-Formatierungsdifferenz: Formatierungsdifferenz Kommentarleerzeile
[id="image-Formatierungsdifferenz",reftext="{figure-caption} {counter:figures}"]
.{desc-image-Formatierungsdifferenz}
image::Einrichtung_Entwicklungsumgebung_009.png[align="center"]

*Bewertung:* Da IntelliJ die Zeilen zwar löscht, aber Eclipse diese nicht wieder hinzufügt, stabilisiert sich dieser Unterschied in der Formatierung nach einem Commit eines Entwicklers, der IntelliJ IDEA verwendet.

[[leerzeilen-bei-for-schleifen-semikolon]]
=== Leerzeichen bei `for`-Schleifen

Beide Formatter erlauben es einzustellen, dass nach dem Semikolon in einer for-Schleife ein Leerzeichen stehen soll. Bei IntelliJ IDEA wird diese Regel streng umgesetzt, auch bei `for(;;)`, währenddessen Eclipse Leerzeichen nur dann einfügt, wenn hinter dem Semikolon noch ein Ausdruck wie beispielsweise `„b > i“` steht.

:desc-image-Formatierungsdifferenz-for: Formatierungsdifferenz Leerzeile in for-Schleife
[id="image-Formatierungsdifferenz-for",reftext="{figure-caption} {counter:figures}"]
.{desc-image-Formatierungsdifferenz-for}
image::Einrichtung_Entwicklungsumgebung_010.png[align="center"]

*Bewertung:* Ein leeres Abbruchkriterium in der `for`-Schleife mag ein Testfall für eine Formatierungsprüfung sein, darf und sollte in der Praxis jedoch nicht vorkommen.

[[behandlung-von-leeren-statements]]
=== Behandlung von leeren Statements

Wenn ein leeres Statement im Quellcode vorhanden ist, fügt IntelliJ IDEA zwei Leerzeilen ein und setzt das Semikolon beim Formatieren in eine neue Zeile.

:desc-image-Formatierungsdifferenz-befehlszeile: Formatierungsdifferenz Befehlszeilenfehler
[id="image-Formatierungsdifferenz-befehlszeile",reftext="{figure-caption} {counter:figures}"]
.{desc-image-Formatierungsdifferenz-befehlszeile}
image::Einrichtung_Entwicklungsumgebung_011.png[align="center"]

*Bewertung:* Ein überflüssiges, leeres Statement-Semikolon ist auffälliger, wenn es am Zeilenanfang steht. Dieser Fall ist allerdings erneut kein Problem der Formatierung, sondern ein Programmierfehler - das Semikolon sollte gelöscht werden.

[[einrichtung-von-checkstyle]]
= Einrichtung von Checkstyle

Die Einbindung und Konfiguration von Checkstyle erfolgt über Plugins in der verwendeten IDE.

== Installation des Plugins

=== Eclipse

*Schritt 1:* Installationsquelle für Checkstyle hinzufügen

* Den Dialog _Install_ öffnen: menu:Window[Help > Install New Software...]
* Neben dem Eingabefeld _Work With:_ auf die Schaltfläche btn:[Add...] klicken und folgende Daten eintragen: +
+
_Name_: Eclipse Checkstyle Plugin +
_Location_: https://checkstyle.github.io/eclipse-cs/update

:desc-image-checkstyle-source: Installationsquelle für Checkstyle hinzufügen
[id="image-checkstyle-source",reftext="{figure-caption} {counter:figures}"]
.{desc-image-checkstyle-source}
image::Einrichtung_Entwicklungsumgebung_012.png[align="center"]

*Schritt 2:* Checkstyle-Plugin installieren

* Den Eintrag _Checkstyle_ auswählen und die Installation mit btn:[Next >] bis zum Ende ausführen.

:desc-image-checkstyle-auswaehlen: Checkstyle-Plugins für Eclipse installieren
[id="image-checkstyle-auswaehlen",reftext="{figure-caption} {counter:figures}"]
.{desc-image-checkstyle-auswaehlen}
image::Einrichtung_Entwicklungsumgebung_013.png[align="center"]

=== IntelliJ IDEA

*Schritt 1:* Checkstyle-Plugin suchen

* Den Dialog _Plugins_ öffnen: menu:[File > Settings... > Plugins]
* Im Suchfeld _checkstyle_ eingeben. Wird kein Treffer angezeigt, dann auf den Link _Search in repositories_ klicken.

:desc-image-checkstyle-suche: Suche nach Checkstyle-Plugin
[id="image-checkstyle-suche",reftext="{figure-caption} {counter:figures}"]
.{desc-image-checkstyle-suche}
image::Einrichtung_Entwicklungsumgebung_014.png[align="center"]

*Schritt 2:* Checkstyle-Plugin installieren

* Das Checkstyle-Plugin mit einem Klick auf die grüne Schaltfläche btn:[Install] installieren.

:desc-image-checkstyle-intellij: Checkstyle-Plugin für IntelliJ IDEA installieren
[id="image-checkstyle-intellij",reftext="{figure-caption} {counter:figures}"]
.{desc-image-checkstyle-intellij}
image::Einrichtung_Entwicklungsumgebung_015.png[align="center"]

== Konfiguration des Plugins

=== Eclipse

*Schritt 1:* Konfigurationmaske des Checkstyle-Plugin in Eclipse öffnen

* Menüeintrag menu:Window[Preferences > Checkstyle]

*Schritt 2:* Import der Checkstyle-Konfiguration von IsyFact

* Mit der Schaltfläche btn:[New...] einen neuen Eintrag anlegen
* Als _Name_ "IsyFact" eingeben
* Mit btn:[Import...] die Checkstyle-Konfiguration aus dem Werkzeugverzeichnis der IsyFact importieren
* Mit btn:[Set as Default] die Konfiguration als Standard aktivieren und den Dialog mit btn:[Apply and Close] schließen

:desc-image-checkstyle-import-eclipse: Import der Checkstyle-Konfiguration für Eclipse
[id="image-checkstyle-import-eclipse",reftext="{figure-caption} {counter:figures}"]
.{desc-image-checkstyle-import-eclipse}
image::Einrichtung_Entwicklungsumgebung_016.png[align="center"]

* Das Checkstyle-Fenster kann anschließend über btn:[Window > Show View > Other... > Checkstyle violations] angezeigt werden

=== IntelliJ IDEA

*Schritt 1:* Konfigurationmaske des Checkstyle-Plugin in Eclipse öffnen

* Menüeintrag menu:[File > Settings... > Checkstyle]

*Schritt 2:* Import der Checkstyle-Konfiguration von IsyFact

* Mit der Schaltfläche btn:[+] einen neuen Eintrag anlegen
* Als _Description_ "IsyFact" eingeben
* Mit btn:[Browse...] die Checkstyle-Konfiguration aus dem Werkzeugverzeichnis der IsyFact importieren
* Mit einem Haken in der Spalte _Active_ die Konfiguration aktivieren

:desc-image-checkstyle-import-intellij: Import der Checkstyle-Konfiguration für IntelliJ IDEA
[id="image-checkstyle-import-intellij",reftext="{figure-caption} {counter:figures}"]
.{desc-image-checkstyle-import-intellij}
image::Einrichtung_Entwicklungsumgebung_017.png[align="center"]

* Das Checkstyle-Fenster kann anschließend über eine Schaltfläche in den _Tool Buttons_ angezeigt werden